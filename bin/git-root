#!/bin/sh

abort () {
  printf "%s\n" "$*" >&2
  exit 1
}

CWD="$PWD"

while :; do
  if [ -d "$CWD"/.git ]; then
    cd "$CWD" && echo "$PWD"
    break
  fi
  if [ "$(realpath -m "$CWD")" = "/" ]; then
    abort "fatal: not a git repository (or any of the parent directories): .git"
  fi
  CWD="$CWD/.."
done
